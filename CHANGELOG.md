# Development environment 3 (devenv3)

## История изменений

### v0.4 (2021/12/16)

###### Значительные изменения:
- Все контейнеры теперь используют Debian **9.13** в качестве базового слоя
- **devenv3.bash**: Команда `init` теперь добавляет `de3`-алиасы и для **zsh**
- **devenv3.bash**: В команду `ls` добавлена поддержка отображения **git**-веток

###### Остальные изменения:
- **nginx**: Добавлена принудительная установка `HTTP`-заголовков `X-Forwarded-Proto`, `X-Real-Ip` и `X-Real-Port`
- **devenv3.bash**: Исправлена работа команды `init` при отсутствующем `~/.bashrc` файле,
  добавлен вывод ошибки при невозможности записи `~/.bashrc` и `.env` файлов
- **devenv3.bash**: заголовок **shebang** заменен на более совместимый вариант
- **php-fpm-**: Добавлен пакет `mercurial` для скачивания зависимостей через `composer`
- **devenv3.bash**: Аргументы команды `build` теперь пробрасываются до `docker-compose`
- **devenv3.bash**: Стандартизирован список допустимых символов в названии приложенения `[[:alnum:]\_-]`
- **devenv3.bash**: Улучшена логика обработки ситуаций, когда домашняя папка приложения находится
  за пределами папки с приложениями
- **devenv3.bash**: Теперь показывается ошибка, если указана несуществующая команда (ранее показывался `help`)

### v0.3 (2019/04/18)

###### Значительные изменения:
- **devenv3.bash**: Добавлена новая команда `rm` для удаления приложений или их алиасов
- **devenv3.bash**: Добавлена новая команда `set_at` для управления параметрами приложений:
  можно указать нужную версию PHP-интерпретатора, использовать или нет XDebug-расширение, а также добавить алиас
- **docker-compose.yml**: В качестве временного решения резолвинга адресов вида `http://*.localhost`
  внутри Окружения разработки (например для прямого обращения `PHP`-приложений к `PHP`-приложениям)
  добавлен контейнер с DNS-сервером `dnsmasq` с полным логированием всех DNS-запросов

###### Остальные изменения:
- **devenv3.bash**: В команду `ls` добавлена новая колонка `TP` (TYPE) с отображением типа приложения
- **devenv3.bash**: В команде `ls` исправлено отображение пути до индексного файла (убран лишний '/')
  в случае его нахождения в корне папки приложения
- **devenv3.bash**: В команду `up` добавлен предварительный запуск `down` команды, что удобнее при обновлении
- **nginx**: Добавлена принудительная установка `HTTP`-заголовка `X-Forwarded-For` для `PHP`-приложений
- **php-fpm-**: Восстановлена работоспособность `PHP`-трассировки (для медленных запросов и исключений)
- **php-fpm-56**, **php-fpm-71**: Добавлено недостающее расширение `php-zip`
- **README.md**: Убрана путаница с использованием синонимов **проект** и **приложение**,
  а также другие мелкие улучшения читабельности и понимания
- Основная разработка теперь ведется в отдельной ветке `develop`

### v0.2 (2019/03/28)

###### Значительные изменения:
- `Makefile` заменен на BASH-скрипт `devenv3.bash` с улучшенной архитектурой и новыми командами:
- - down
- - ls
- - run
- - run_at

###### Остальные изменения:
- В контейнеры добавлен проброс `/dev/log` для корректной работы `syslog`
- Удалено использование неработающего репозитария 'jessie-updates' (устарел) из всех контейнеров
- Добавлен `UPGRADING.md`
- В отдельный контейнер добавлен `composer` последней версии
- Директории `configs` с конфигурацией для `Docker`-образов переименованы в `root`
- **php-fpm-***: Добавлены пакеты `git`, `libdbi-perl`, `libdbd-mysql-perl`, `mysql-client-5.5`, `unzip` для работы миграций
- **nginx**: Добавлен аргумент `NGINX_VERSION` в `Dockerfile`
- Добавлен `CHANGELOG.md`

### v0.1 (2019/02/05)

- Добавлен `README.md`
- Уменьшен размер `opcache` для `PHP`-обработчиков с 512 до 256 Мбайт
- Добавлена поддержка `.profile-xdebug` и `php-fpm-71`, `php-fpm-72` обработчиков
- Папка приложений перемещена из `/opt/www` в `~/www`
- Первая внутренняя версия
